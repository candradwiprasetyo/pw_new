jQuery(document).ready(function($){function ProjectMask(element){this.element=element;this.projectTrigger=this.element.find('.project-trigger');this.projectClose=this.element.find('.project-close');this.projectTitle=this.element.find('h1');this.projectMask=this.element.find('.mask');this.maskScaleValue=1;this.bgImage=this.element.find('.featured-image');this.projectContent=this.element.find('.cd-project-info');this.projectContentUrl=this.projectContent.data('url');this.animating=!1;this.scrollDown=this.element.find('.cd-scroll');this.scrolling=!1;this.initProject()}
ProjectMask.prototype.initProject=function(){var self=this;this.projectTrigger.on('click',function(event){event.preventDefault();if(!self.animating){self.animating=!0;self.uploadContent();if($(window).scrollTop()==self.element.offset().top){self.revealProject()}else{$('body,html').animate({'scrollTop':self.element.offset().top},400).promise().then(function(){self.revealProject()})}
$('#scene2').hide()}});this.projectClose.on('click',function(event){event.preventDefault();if(!self.animating){self.animating=!0;self.projectTitle.attr('style','opacity: 0;');self.element.removeClass('content-visible');self.projectContent.one(transitionEnd,function(){self.projectContent.off(transitionEnd);self.projectContent.scrollTop(0);self.element.removeClass('center-title')});self.element.addClass('scaling-down');void self.projectMask.get(0).offsetWidth;self.projectMask.css('transform','translateX(-50%) translateY(-50%)');self.bgImage.one(transitionEnd,function(){self.bgImage.off(transitionEnd);self.animating=!1;self.maskScaleValue=1;self.element.removeClass('project-selected scaling-down').parent('.cd-image-mask-effect').removeClass('project-view');$('body,html').scrollTop(self.element.offset().top);self.projectTitle.attr('style','');window.history.pushState({path:'/wedding'},'','wedding')});$('#scene2').show()}});this.scrollDown.on('click',function(event){event.preventDefault();self.projectContent.animate({'scrollTop':$(window).height()},300)});this.projectContent.on('scroll',function(){if(!self.scrolling){self.scrolling=!0;(!window.requestAnimationFrame)?setTimeout(function(){self.checkScrolling()}):window.requestAnimationFrame(function(){self.checkScrolling()})}})};ProjectMask.prototype.revealProject=function(){var self=this;self.updateMaskScale();self.projectTitle.attr('style','opacity: 0;');self.projectMask.css('transform','translateX(-50%) translateY(-50%) scale('+self.maskScaleValue+')').one(transitionEnd,function(){self.projectMask.off(transitionEnd);self.animating=!1;self.element.addClass('center-title');self.projectTitle.attr('style','')});self.element.addClass('project-selected content-visible').parent('.cd-image-mask-effect').addClass('project-view')}
ProjectMask.prototype.updateMask=function(){var self=this;if(this.element.hasClass('project-selected')){this.updateMaskScale();this.element.addClass('no-transition');void self.projectMask.get(0).offsetWidth;self.projectMask.css('transform','translateX(-50%) translateY(-50%) scale('+self.maskScaleValue+')');void self.projectMask.get(0).offsetWidth;self.element.removeClass('no-transition')}}
ProjectMask.prototype.updateMaskScale=function(){this.maskScaleValue=Math.sqrt(Math.pow($(window).height(),2)+Math.pow($(window).width(),2))*5*this.maskScaleValue/this.projectMask.width()}
ProjectMask.prototype.uploadContent=function(){var self=this;if(self.projectContent.find('.content-wrapper').length==0)self.projectContent.load(self.projectContentUrl+' .cd-project-info > *');if(self.projectContentUrl!=window.location){}}
ProjectMask.prototype.checkScrolling=function(){(this.projectContent.scrollTop()>0)?this.element.addClass('scrolling'):this.element.removeClass('scrolling');this.scrolling=!1}
var revealingProjects=$('.cd-project-mask');var objProjectMasks=[],windowResize=!1;var transitionEnd='webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend';if(revealingProjects.length>0){revealingProjects.each(function(){objProjectMasks.push(new ProjectMask($(this)))})}
$(window).on('resize',function(){if(!windowResize){windowResize=!0;(!window.requestAnimationFrame)?setTimeout(checkResize):window.requestAnimationFrame(checkResize)}});function checkResize(){objProjectMasks.forEach(function(element){element.updateMask()});windowResize=!1}})